<!DOCTYPE html><html lang="en"><head>

    <meta charset="utf-8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, width=device-width">

    <title>Mekks: Mekkanic Duels</title>
    <meta name="author" content="Patrick Blaine">

    <script>
    
    var defaultMessage = 'tap or rotate';

    function removeAllActives() {var numberOfActive = document.getElementsByClassName('active').length; for (var i=0; i < numberOfActive; i++){removeClass('active',document.getElementsByClassName('active')[i])}}

    function updateActiveToElement(elementName) {document.getElementsByClassName('active')[0].dataset.element=elementName; removeAllActives(); resetMessage()}

    function getWeakForElement(elementName)
    {
      switch(elementName)
      {
        case "fire":
          return "aqua";
        case "aqua":
          return "leaf";
        case "leaf":
          return "fire";
        default:
          return "";
      }
    }
    
    function getStrongForElement(elementName)
    {
      switch(elementName)
      {
        case "fire":
          return "leaf";
        case "aqua":
          return "fire";
        case "leaf":
          return "aqua";
        default:
          return "";
      }
    }

    function checkElementButtons()
{
   var fireCount = getElementCountFor('fire'); 
var fireButton = document.getElementsByClassName('attack fire')[0];
if (fireCount == 0) {fireButton.disabled = "disabled";fireButton.onclick = ""; fireButton.style.opacity = "0.5"} else {fireButton.disabled = "";fireButton.onclick = function() {elementButtonClicked('fire')};fireButton.style.opacity = "1"}

   var aquaCount = getElementCountFor('aqua'); 
var aquaButton = document.getElementsByClassName('attack aqua')[0];
if (aquaCount == 0) {aquaButton.disabled = "disabled";aquaButton.onclick = ""; aquaButton.style.opacity = "0.5"} else {aquaButton.disabled = "";aquaButton.onclick=function() {elementButtonClicked('aqua')};aquaButton.style.opacity = "1"}

   var leafCount = getElementCountFor('leaf'); 
var leafButton = document.getElementsByClassName('attack leaf')[0];
if (leafCount == 0) {leafButton.disabled = "disabled";leafButton.style.opacity = "0.5";leafButton.onclick=""} else {leafButton.disabled = ""; leafButton.style.opacity = "1"; leafButton.onclick=function(){elementButtonClicked('leaf')};}
}
    
    function tinkerForElement(elementName)
    {
      document.getElementsByClassName('left')[0].disabled=false;
      document.getElementsByClassName('left')[0].innerHTML = getWeakForElement(elementName);
      document.getElementsByClassName('left')[0].dataset.element = getWeakForElement(elementName);
      updateMessage('&nbsp;');
      document.getElementsByClassName('right')[0].disabled=false;
      document.getElementsByClassName('right')[0].innerHTML = getStrongForElement(elementName);
      document.getElementsByClassName('right')[0].dataset.element = getStrongForElement(elementName);
    }

    function getElementCountFor(elementName)
{
var count=0; var mekkcells = document.getElementsByClassName('viewcell player')[0].getElementsByClassName('mekkcell'); for (var i = 0; i < mekkcells.length; i++) {console.log(mekkcells[i].dataset.element); if (elementName == mekkcells[i].dataset.element) {count++}}; return count;
}

    function addClassToParent(targetClassName,context) {removeAllActives();context.parentNode.className += ' '+targetClassName; 
var message = context.parentNode.dataset.element;
updateMessage(message);
console.log(parseInt(context.parentNode.getElementsByClassName('tinker')[0].innerHTML)+' clicked, element: '+context.parentNode.dataset.element);
}

    function removeClassFromParent(targetClassName,context) {
      var classList = context.parentNode.classList; var className = ''; for (var i = 0; i < classList.length; i++) {if (classList[i] != targetClassName) {className += classList[i]+' '}}; context.parentNode.className = className;console.log(context.parentNode.getElementsByClassName('tinker')[0].innerHTML +' cancelled');
resetMessage();
    }

    function removeClass(targetClassName,context) {
      var classList = context.classList; var className = ''; for (var i = 0; i < classList.length; i++) {if (classList[i] != targetClassName) {className += classList[i]+' '}}; context.className = className; console.log(context.parentNode.getElementsByClassName('tinker')[0].innerHTML +' cancelled');
resetMessage();
    }

    function resetMessage() {
document.getElementsByClassName('message')[0].innerHTML = defaultMessage;
console.log('message reset, resetting buttons');
      document.getElementsByClassName('left')[0].disabled=true;
      document.getElementsByClassName('left')[0].innerHTML = '';
      document.getElementsByClassName('left')[0].dataset.element = '';
      document.getElementsByClassName('right')[0].disabled=true;
      document.getElementsByClassName('right')[0].innerHTML = '';
      document.getElementsByClassName('right')[0].dataset.element = '';
    
}

function elementButtonClicked(elementName)
{
var count = getElementCountFor(elementName); console.log(count); alert('attacked with '+elementName+' x'+count);
}

function updateMessage(message) {
document.getElementsByClassName('message')[0].innerHTML = message;
console.log('message changed to: '+message);
}
    </script>

    <style>

      html
      {
        font-size:100%;
      }

      body
      {
        font-size:20px;
        min-height:1em;
        margin:0;
        border:0;
        padding:0;
        -webkit-text-size-adjust:100%;
        display:block;
      }

      #container
      {
        position:absolute;
        top:0;
        bottom:0;
        left:0;
        right:0;
      }

      .table
      {
          display: table;
      }

      .tablecell
      {
      display: table-cell;
      vertical-align: middle;
      word-wrap: break-word;
      word-break: break-word;
      }
      
      .message
      {
        width:60%;
      }
      
      .text-center
      {
       text-align:center;
      }
      
      .text-left
      {
       text-align:left;
       padding-left:1em;
      }
      
      
      .text-right
      {
       text-align:right;
       padding-right:1em;
      }
      
      .viewcell
      {
        height:20%;
        background: white;
        width:100%;
      }

      .progress-bar
{
width:100%;
height:inherit;
border-style: inset;
border-right-width: 0vmin;
border-top-width:0;
border-left-width:0;
border-bottom-width:0;
background:rgba(0,0,0,0.5);
border-color:rgba(255,255,255,0.5);
}

      .mekk
      {
        height:40%;
      }
      
      .mekkcell
      {
      float: left;
      background: gray;
      height: 50%;
      width: 50%;
      transition: 0.25s all;
      overflow: hidden;
      }
      
            a[data-element=""]
            {
                display:none;
            }
            
            a, a:visited
            {
              color:white;
              text-decoration: none;
              opacity:1;
              
              text-shadow: 0px 0px 10px rgba(255, 255, 255, 0.5);
              transition:0.25s all;
              -webkit-touch-callout: none;      
              -webkit-user-select: none;
              -khtml-user-select: none;
              -moz-user-select: none;
              -ms-user-select: none;
              user-select: none;
              cursor:pointer;
            }
            
            a:hover, a:active
            {
              text-shadow: 0px 0px 20px rgba(255, 255, 255, 0.95);
            }

            .mekkcell:nth-child(1)
            {
              border-top-left-radius: 100%;
            }

            .mekkcell:nth-child(2)
            {
              border-top-right-radius: 100%;
            }

            .mekkcell:nth-child(3)
            {
              border-bottom-left-radius: 100%;
            }

            .mekkcell:nth-child(4)
            {
              border-bottom-right-radius: 100%;
            }
      
      .left
      {
        border-radius:0;
        border-top-right-radius:25%;
        width: 20%;
      }

      .margin
      {
        display:table-cell;
        width:auto;
        background:none;
      }

      .right
      {
        border-radius:0;
        border-top-left-radius:25%;
        width: 20%;
      }
        

        .attack.fire
        {
          border-top-left-radius:25%;
          border-bottom-left-radius:0;
        }
        
        .attack
        {
          border-radius: 0;
          width:20%;
        }
        
        .attack.aqua
        {
          border-top-right-radius:25%;
          border-bottom-right-radius:0;
        }
    
    [data-element="fire"]
    {
      background:red;
    }
    
    [data-element="leaf"]
    {
      background:green;
    }
    
    [data-element="aqua"]
    {
      background:blue;
    }

      .mekkcell.active
      {
        border-radius: 25%;
      }
      
      .mekkcell.active:nth-of-type(1)
      {
        border-top-right-radius: 0;
        border-bottom-left-radius: 0;
      }
      
      .mekkcell.active:nth-of-type(2)
      {
        border-top-left-radius: 0;
        border-bottom-right-radius: 0;
      }
      
      .mekkcell.active:nth-of-type(3)
      {
        border-top-left-radius: 0;
        border-bottom-right-radius: 0;
      }
      
      .mekkcell.active:nth-of-type(4)
      {
        border-top-right-radius: 0;
        border-bottom-left-radius: 0;
      }
        
        .mekkcell:not(.active) .cancel {
            display: none;
        }

      .mekkcell.active .tinker
      {
        display:none;
      }
      
@media (orientation:portrait) {
.hidden-landscape
{
  display:auto;
}

.hidden-portrait
{
  display:none;
}
}

      @media (orientation:landscape) {

          .viewcell
          {
            height: 25%;
          }

          .mekk
          {
            width: 50%;
            float:left;
          }

          .hidden-landscape
          {
            display:none;
          }
          
          .hidden-portrait
          {
            display:auto;
          }

      }

    </style>

  </head>

  <body>

   <div id="container">

     <div class="viewcell">&nbsp;</div>

     <div class="viewcell">&nbsp;</div>

     <div class="viewcell mekk player text-center">
      <div class="mekkcell table" data-element="fire">
        <a href="#1" class="hidden-landscape tinker tablecell" onclick="addClassToParent('active',this); tinkerForElement(this.parentNode.dataset.element);">&nbsp;</a>
        <a href="#cancel" class="hidden-landscape cancel tablecell" onclick="removeClassFromParent('active',this);">X</a>
      </div>
      <div class="mekkcell table" data-element="fire">
        <a href="#2" class="hidden-landscape tinker tablecell" onclick="addClassToParent('active',this); tinkerForElement(this.parentNode.dataset.element);">&nbsp;</a>
        <a href="#cancel" class="hidden-landscape cancel tablecell" onclick="removeClassFromParent('active',this)">X</a>
      </div>
      <div class="mekkcell table" data-element="fire">
        <a href="#3" class="hidden-landscape tinker tablecell" onclick="addClassToParent('active',this); tinkerForElement(this.parentNode.dataset.element);">&nbsp;</a>
        <a href="#cancel" class="hidden-landscape cancel tablecell" onclick="removeClassFromParent('active',this)">X</a>
      </div>
      <div class="mekkcell table" data-element="fire">
         <a href="#4" class="hidden-landscape tinker tablecell" onclick="addClassToParent('active',this); tinkerForElement(this.parentNode.dataset.element);">&nbsp;</a>
         <a href="#cancel" class="hidden-landscape cancel tablecell" onclick="removeClassFromParent('active',this)">X</a>
      </div>
     </div>
     
     <div class="hidden-portrait viewcell mekk enemy">
              <div class="mekkcell" data-element="leaf">
                      <span>&nbsp;</span>
              </div>
              <div class="mekkcell" data-element="leaf">

                      <span>&nbsp;</span>
              </div>
              <div class="mekkcell" data-element="leaf">

                      <span>&nbsp;</span>
              </div>
              <div class="mekkcell" data-element="leaf">

                      <span>&nbsp;</span>
              </div>
      </div>

      <div class="viewcell table text-center">

              <a class="hidden-portrait attack fire tablecell" href="#attack/fire" data-element="fire" onclick="elementButtonClicked(this.dataset.element)">fire</a>
              <a class="hidden-landscape left tablecell" onclick="updateActiveToElement(this.innerHTML);this.innerHTML='';this.dataset.element='';checkElementButtons()"  data-element=""></a>
              <div class="hidden-landscape margin tablecell"></div>
              <a class="hidden-portrait attack leaf tablecell" href="#attack/leaf" data-element="leaf" onclick="elementButtonClicked(this.dataset.element)">leaf</a>
              <span class="hidden-landscape message tablecell text-center" onload="this.innerHTML = defaultMessage;">tap or rotate</span>
              <div class="hidden-landscape margin tablecell"></div>
              <a class="hidden-portrait attack aqua tablecell" href="#attack/aqua" data-element="aqua" onclick="elementButtonClicked(this.dataset.element)">aqua</a>
              <a class="hidden-landscape right tablecell" onclick="updateActiveToElement(this.innerHTML);this.innerHTML='';this.dataset.element='';checkElementButtons()" data-element=""></a>
       
     </div>

   </div>

</body>

</html>
