<!doctype html>
<html>
    
    <head>
        <meta charset="utf-8">

        <title>Mekks</title>
        <meta name="description" content="Description of Mekks">
        <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
		
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
        <link rel="stylesheet" href="css/styles.css">
		
		<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
        <script src="http://www.parsecdn.com/js/parse-1.5.0.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    </head>

    <body>
      <div id="app" class="container-fluid">
                <div class="row" id="header">
                    <div class="col-xs-3 text-left">
                        <h3 class="health-label"><span class="label label-primary" id="player-health">
                            <span class="glyphicon glyphicon-heart-empty"></span>   
                            <span class="health-points">100</span>
                        </span></h3>
                    </div>
                    
                    <div class="col-xs-6 text-center">
                        <h3 class="energy-cells">
                            <span class="label label-success energy-cell">
                            <span class="glyphicon glyphicon-flash"></span>
                        </span>
                            <span class="label label-success energy-cell">
                            <span class="glyphicon glyphicon-flash"></span>
                        </span>
                            <span class="label label-success energy-cell">
                            <span class="glyphicon glyphicon-flash"></span>
                        </span>
                        </h3>
                    </div>
                    
                    <div class="col-xs-3 text-right">
                        <h3 class="health-label">
                            <span class="label label-warning" id="enemy-health">
                            <span class="glyphicon glyphicon-heart-empty"></span>   
                            <span class="health-points">100</span></span>
                        </h3>
                    </div>

                    

                </div>

                <div class="row" id="content">
                    <div class="col-xs-6">
                        <div class="mekk" id="player">

                        </div>
                    </div>
                    <div class="col-xs-6">
                        <div class="mekk" id="enemy">

                        </div>
                    </div>
                </div> 
                        <div class="row" id="footer">
                            <div class="col-xs-6 text-left">
                                <button class="btn btn-info tinker-btn">
                                    <span class="glyphicon glyphicon-briefcase"></span>
                                </button>
                            </div>
                            <div class="col-xs-6 text-right">
                                <button class="btn btn-danger attack-btn">
                                    <span class="glyphicon glyphicon-screenshot"></span>
                                </button>
                            </div>
                        </div>
            </div>
        
        <script type="text/template" id="template">
        </script>
        
        <script>
            $(function(){
                // code to run on loading of DOM
                
                var rechargeSpeed  = 18000;
                
                
                 var attackButtonToggle = function(){this.toggleClass('disabled')};
                    attackButtonToggle = attackButtonToggle.bind($('.attack-btn'));
                
                function useEnergyCell(cell) {
                    cell = $(cell);
                    if (!cell.hasClass('disabled'))
                    {
                    cell.addClass('disabled');
                cell.removeClass('label-success');
                cell.addClass('label-danger');
                cell.hide();
                var rechargeComplete = function (){
                    this.removeClass('label-danger');
                    this.addClass('label-success');
                    this.removeClass('disabled');
                    if ($('.attack-btn').hasClass('disabled')) {
                        attackButtonToggle()};
                    }
                    rechargeComplete = rechargeComplete.bind(cell);
                    cell.fadeIn(rechargeSpeed,rechargeComplete);
                    }
                }
                
                function energyCellClicked(e) {
                    useEnergyCell($(e.currentTarget));
                }
                
                function attackButtonClicked(e){
                   
                    if (!$('attack-btn').hasClass('disabled'))
                    {
                    var cells = $('.energy-cell').toArray();
                    for (var cell in cells)
                    {
                        if (!$(cells[cell]).hasClass('disabled'))
                        {
                            useEnergyCell(cells[cell]);
                            if ($('.energy-cell.disabled').toArray().length == cells.length)
                            {
                                attackButtonToggle();
                            }
                            return;
                        }
                        }
                    }
                }
                
                $('.attack-btn').on('click',attackButtonClicked);
            });
        </script>
        
    </body>

</html>
